\section{Method of regularised stokeslets}
\subsection{Stokes flow}
When we analyse many physical systems, particularly in microscopic biology, we find that the inertial forces within the fluid are small in comparison to that of the viscous terms. In these cases we can take the limit of the Navier-Stokes equation (\cref{eq:NavierStokes})where $R e=\rho u L/\mu \to 0 $ \cite{Trombley2019BasicFlows}. In this limit, we obtain the steady-state Stokes equations in two or three dimensions as 
\begin{subequations}
\label{eq:StokesFlow}
\begin{align}
    \mu\Delta\boldsymbol{u} &= \nabla p - \boldsymbol{F} \label{eq:StokesFlow1} \\
    \nabla \cdot \boldsymbol{u} &= 0 \label{eq:StokesFlow2}
\end{align}
\end{subequations}
where $\bm{u}$ is the velocity of the fluid, $\bm{F}$ is the external body force, $p$ is the pressure and $\mu$ is the fluid viscosity.

Stokes flows occur when either where $\mu$ is large or at small length scales where $L$ (typical scale of the system) is very small such as when analysing the flows around cell, microorganism's or small capillaries \cite{Blake1972AOrganisms, Higdon1979APropulsion, Smith2009MathematicalFluids}. Stokes flow is not only useful in modelling flows in microbiology but in non-biological systems such are industrial applications with small scale flows and complex boundaries stokes flow with complex boundaries \cite{Liron1978StokesPipe, Liron1976StokesPlates}.

When looking for solutions to the the Stokes equation \cref{eq:StokesFlow} there are many different techniques we can use both numerically and analytically we will be focusing on the use of the Green's function of Stokes flow called a \textit{stokeslet}\cite{Pozrikidis1992BoundaryFlow,Hancock1953TheLiquids} or \textit{Oseen tensor}\cite{Oseen1927NeuereHydrodynamik}. The stokeslet represents a fundamental solution for the velocity of the fluid given that an external force $\bm{F}$ acts on the fluid at a single point $\bm{F} = \bm{f_0}\delta(\bm{x})$ \cite{Hancock1953TheLiquids, Batchelor2000AnDynamics}.
Through similar methods to those shown later for deriving the regularised stokeslet Equation, (\cref{eq:regstokeslet2}) we can derive the singular fundamental solutions to the Stokes equations as
\begin{equation}
\label{eq:singularsolutions}
\begin{aligned}
    S_{j k}(\bm{x}, \bm{y}) &= \frac{\delta_{j k}}{r}+\frac{\left(x_{j}-y_{j}\right)\left(x_{k}-y_{k}\right)}{r^{3}} \\
    P_{k}(\bm{x}, \bm{y}) &= \frac{x_{k}-y_{k}}{r^{3}} \\
    T_{ijk}(\bm{x}, \bm{y}) &= \frac{-6\left(x_{i}-y_{i}\right)\left(x_{j}-y_{j}\right)\left(x_{k}-y_{k}\right)}{r^5}
\end{aligned}
\end{equation}
Where $r=|\bm{x}-\bm{y}|$. We can then find the velocity $\bm{u}$ and pressure $p$ at a point $\bm{x}$ through the equations
\begin{equation*}
    \bm{u} = (8 \pi \mu)^{-1} \left(S_{1j},S_{2j},S_{3j}\right)f_{0,j}, \quad p = (8 \pi)^{-1} P_k f_{0,j} 
\end{equation*}
where $\bm{f_{0}}$ is the force per unit area exerted by the fluid on the surface, concentrated at the point $\bm{y}$.


\subsection{Regularising the stokeslet}
While the singular stokeslet provides a useful mechanism to solve boundary integral equations, the solutions contain singular points which prove computationally challenging unless careful consideration of the the quadrature discretization is considered where we don not need to evaluate close to these singular points.

\begin{figure}[ht]
    \centering
    \resizebox{.6\linewidth}{!}{\input{Images/BlobFunction}}
    \caption{Cutoff function in equation \cref{eq:blobfunc} for several values of $\epsilon$}
    \label{fig:blobfunc}
\end{figure}

In order to remove these singularities, we use a cutoff function \cite{Cortez2001,Cortez2005} which, instead of approximating the force at a singular point we instead approximate it as a sphere centred at the same point. While the radius of the sphere is often infinite, the cutoff function decays rapidly away from the centre with the largest contribution obtained in the close vicinity of the centre. We introduce a control parameter $\epsilon$, independent of any discretization, to control the rate of decay of the function. The effect of this control parameter can be seen in \cref{fig:blobfunc}. In order to obtain similar results to that of the singular solutions, we dictate that $\int \phi^\epsilon(r)dr=1$ for all values of $\epsilon$ . This allows us to preserve the results obtained for the singular kernels for points far away from where the force is exerted and obtain different results close to the point due to the regularisation error introduced. In order to retain the singular solution, we have the condition that as $\epsilon \to 0$ our cutoff function must tend to the Dirac delta function. For simplicity of the paper and the application to a wider range of problems \cite{Olson2013ModelingFormulation}, we will only consider spherically symmetric functions such as those in \cref{eq:blobfunc,eq:blobfunc2,eq:blobfunc3} \cite{Olson2013ModelingFormulation,Nguyen2014ReductionFlow,Zhao2019}.

\begin{align}
    \label{eq:blobfunc}\phi^\epsilon(r) &= \dfrac{15 \epsilon^4}{8\pi\left( r^2 +\epsilon^2 \right)^{7/2}} \\
    \label{eq:blobfunc2}\phi^{\epsilon}(r) &= \dfrac{15 \epsilon^{6}\left(5-\frac{2 r^{2}}{\epsilon^{2}}\right)}{16 \pi\left(r^{2}+\epsilon^{2}\right)^{9 / 2}}\\
    \label{eq:blobfunc3}\phi^{\epsilon}(r) &= \dfrac{5 \epsilon^{2}-2 r^{2}}{2 \pi^{3 / 2} \epsilon^{5}} e^{-r^{2} / \epsilon^{2}} 
\end{align}   
For the derivation of the regularised stokeslets and all further numerical analysis, we will use \cref{eq:blobfunc} due to its popularity in external literature and the simplicity of the kernel it generates.

\subsubsection{Derivation of the regularised stokeslet}
The work done in this section is heavily based of that of Cortez, Fauci and Medovikov\cite{Cortez2001,Cortez2005}. By concentrating the force onto a finite area using the cutoff function rather than a singular point as with the delta function Cortez proposed we convert the stokes equations given in \cref{eq:StokesFlow} to a new set of regularised equations for which we will derive a set of solutions,
\begin{subequations}
\label{eq:RegStokesFlow}
\begin{align}
    \mu\Delta\boldsymbol{u} &= \nabla p - \phi^{\epsilon}(\bm{x}-\bm{y})\bm{f_0} \label{eq:RegStokesFlow1} \\
    \nabla \cdot \boldsymbol{u} &= 0 \label{eq:RegStokesFlow2}
\end{align}
\end{subequations}
where $\bm{f}_0$ is the force per unit area as defined in the previous section.
In order to simplify notation from this point onwards, we will use the Einstein summation convention where repeated indices are summed over. We introduce the regularised stokeslet function $S^\epsilon(\bm{x},\bm{y})$ which is the Green's function for the velocity $u^\epsilon(\bm{x})$. We can now write the solution to \cref{eq:RegStokesFlow} as
\begin{equation}
\label{eq:regvelsol}
    u_i(\bm{x}) = \frac{1}{8\pi\mu}S^\epsilon_{ij}(\bm{x},\bm{y})f_{0,j}
\end{equation}
The pressure and stress tensor associated with this flow can now be written as
\begin{gather}
\label{eq:regpressuresol}
    p(\bm{x}) = \frac{1}{8\pi}P^\epsilon_{j}(\bm{x},\bm{y})f_{0,j}\\
\label{eq:regstresssol}
    \sigma_{ik}(\bm{x}) = \frac{1}{8\pi}T^\epsilon_{ijk}(\bm{x},\bm{y})f_{0,j}
\end{gather}
By substituting these solutions back into \cref{eq:RegStokesFlow1} we find that they must obey
\begin{equation}
\label{eq:regcondition1}
    \Delta S^\epsilon_{kj}(\bm{x},\bm{y}) = \frac{\partial P^\epsilon_{j}(\bm{x},\bm{y})}{\partial x_k} - 8\pi\delta_{kj}\phi^\epsilon(\bm{x}-\bm{y})
\end{equation}
for all $j=1,2,3$ and $k=1,2,4$ with $\delta_{kj}$ being the Kronecker delta function. The incompressibility condition \cref{eq:RegStokesFlow2} also gives us that
\begin{equation}
\label{eq:regcondition2}
    \frac{\partial S^\epsilon_{ij}(\bm{x},\bm{y})}{\partial x_i} = 0
\end{equation}
for all $j=1,2,3$. We next take the derivative of \cref{eq:regcondition1} with respect to $x_k$ to get
\begin{equation*}
    \frac{\partial S^\epsilon_{kj}(\bm{x},\bm{y})}{\partial x_i \partial x_i \partial x_k} = \frac{\partial^2 P^\epsilon_{j}(\bm{x},\bm{y})}{\partial x_k^2} - 8\pi\delta_{kj}\frac{\partial \phi^\epsilon(\bm{x}-\bm{y})}{\partial x_k}
\end{equation*}
Summing over $k$ as per the convention and using \cref{eq:regcondition2} gives us
\begin{equation}
\label{eq:regpressureeq}
    \Delta P^\epsilon_{j}(\bm{x},\bm{y}) = 8\pi\frac{\partial \phi^\epsilon(\bm{x}-\bm{y})}{\partial x_j}.
\end{equation}

In order to solve the regularised Stokes equation we introduce the regularised Laplace's equation \cref{eq:inter1} which has solution $G^\epsilon$ and the Poisson equation with $G^\epsilon$ on the right hand side \cref{eq:inter2}. This is also a regularised biharmonic equation $\Delta \Delta B^\epsilon  (\bm{x}-\bm{y}) = \phi^\epsilon(\bm{x}-\bm{y})$. 
\begin{subequations}
\label{eq:intermediate}
\begin{align}
    \Delta G^\epsilon(\bm{x}-\bm{y})  &= \phi^\epsilon(\bm{x}-\bm{y}) \label{eq:inter1} \\
    \Delta B^\epsilon(\bm{x}-\bm{y})  &= G^\epsilon(\bm{x}-\bm{y}) \label{eq:inter2}
\end{align}
\end{subequations}
In this change of variable we are now working with scalar potentials $G^\epsilon$ and $b^\epsilon$ instead of the pressure and velocity. This allows us to express the pressure tensor, second rank stokeslet and Stress tensor in terms of these potentials. By our choice of spherically symmetric cutoff function we also obtain easy solutions to both of these equations. Combining \cref{eq:inter1,eq:regpressureeq,eq:regcondition1,eq:inter2} we can form the solution to $P^\epsilon$ and $S_{ij}$ in terms of $G^\epsilon$ and $B^\epsilon$,
\begin{equation}
\label{eq:pressuresol}
    P^\epsilon_{j}(\bm{x},\bm{y})f_{0,j} = 8 \pi \frac{\partial G^\epsilon(\bm{x}-\bm{y})}{\partial x_j}
\end{equation}
and
\begin{equation}
\label{eq:regstokeslet1}
    S_{ij}^\epsilon(\bm{x}, \bm{y}) = 8\pi\left[ \frac{\partial^2 B^\epsilon(\bm{x} -\bm{y})}{\partial x_i \partial x_j} - \delta_{ij}  G^\epsilon(\bm{x} -\bm{y})\right]
\end{equation}
Using the definition of the regularised stress tensor 
\begin{equation}
\label{eq:regstress}
    \sigma_{ij}^\epsilon(\bm{x}) = -\delta_{ik}p^\epsilon(\bm{x}) + \mu\left( \frac{\partial u^\epsilon_i}{\partial x_k} + \frac{\partial u^\epsilon_k}{\partial x_i} \right)
\end{equation}
and the definition of velocity in terms of the stokeslet \cref{eq:regvelsol} we find that the double layer potential can be written as 
\begin{equation}
\label{eq:regDoubleLayerSol}
    T^\epsilon_{ijk}(\bm{x},\bm{y}) = -\delta_{ik} P^\epsilon_j(\bm{x},\bm{y}) + \mu\left( \frac{\partial S^\epsilon_{ij}(\bm{x},\bm{y})}{\partial x_k} + \frac{\partial S^\epsilon_{kj}(\bm{x},\bm{y})}{\partial x_i}\right)
\end{equation}

\subsubsection{Specific cutoff function}
In order to define usable form's for the $S^\epsilon$, $P^\epsilon$ and $T^\epsilon$ we need to calculate $G^\epsilon$ and $B^\epsilon$ for our given choice of cutoff function. By solving the Laplace and Possion equation for \cref{eq:blobfunc} we obtain that 
\begin{subequations}
\begin{align}
    G^\varepsilon(\bm{x}-\bm{y}) &= \frac{-2r^2+3\epsilon^2}{8\pi(r^2+\epsilon^2)^{3/2}} + \frac{3}{8\pi\epsilon} \label{eq:G}\\
    B^\varepsilon(\bm{x}-\bm{y}) &= -\frac{\sqrt{\epsilon^2+r^2}}{8\pi} + \frac{r^2}{16\pi\epsilon} + \frac{\epsilon}{8\pi}\label{eq:B}
\end{align}
\end{subequations}
where $r=|\bm{x}-\bm{y}|$. We now substitute \cref{eq:G,eq:B} into \cref{eq:pressuresol,eq:regstokeslet1,eq:regDoubleLayerSol} to obtain our final kernels which will be used in all further analysis.
\begin{subequations}
\begin{align}
    S_{ij}^\epsilon(\bm{x}, \bm{y}) =& \delta_{ij} \frac{r^2+2\epsilon^2}{\left( r^2 + \epsilon^2 \right)^{3/2}} + \frac{(x_i-y_{i})(x_j-y_{j})}{\left( r^2 + \epsilon^2 \right)^{3/2}}, \label{eq:regstokeslet2} \\
    P_j^\epsilon(\bm{x}, \bm{y}) =& (x_j-y_{j})\frac{2r^2+5\epsilon^2}{(r^2+\epsilon^2)^{5/2}} \text{ and } \label{eq:pressuresol2} \\
    T_{ijk}^\epsilon(\bm{x}, \bm{y}) =& \frac{-6(x_i-y_{i})(x_j-y_{j})(x_k-y_{k})}{(r^2+\epsilon^2)^{5/2}} \label{eq:doublelayer2}\\
    &-\frac{3\epsilon^2[\delta_{jk}(x_i-y_{i}) +\delta_{ik}(x_j-y_{j})+\delta_{ij}(x_k-y_{k})]}{(r^2+\epsilon^2)^{5/2}} \nonumber
\end{align}
\end{subequations}
We can easily check that these solutions provide results consistent with those found by the singular solutions as in the limit $\epsilon \to 0$ we obtain the same equations stated in \cref{eq:singularsolutions}.

\subsubsection{Boundary integral equations}
In order to use the above relations to compute the flows around solid boundaries or objects we need to consider the effect of an integral over the boundary of surface, computing the effect of stokeslet at each point on a target point. It has been proven that the solution to elliptic PDE's such as the Stokes flow equation can be solved through the integral over the boundary of the object \cite{Stakgold1968Boundary2,Pozrikidis1992BoundaryFlow}. The most common starting point for deriving the Boundary integral equations is that of the Lorentz reciprocal identity which states for any two non-singular (regular) flows $u$ and $u^\prime$ with stress $\sigma$ and $\sigma^\prime$ respectively we have that the 
\begin{equation*}
    \frac{\partial}{\partial x_k}(u_i^\prime\sigma_{ik} - u_i \sigma^\prime_{ik}) = 0
\end{equation*}
We instead present a modified version of the Lorentz reciprocal identity, if we consider the the Stokes equations
\begin{equation}
    \label{eq:BIE1}
\begin{aligned}
      \mu\Delta\boldsymbol{u} &= \nabla p \\
      \nabla \cdot \boldsymbol{u} &= 0
\end{aligned}
\end{equation}
and regularised Stokes equation
\begin{equation}
    \label{eq:BIE2}
\begin{aligned}
      \mu\Delta\boldsymbol{u} &= \nabla p - \phi_{\epsilon}(\bm{x}-\bm{x_0})\bm{f_0} \\
      \nabla \cdot \boldsymbol{u} &= 0
\end{aligned}
\end{equation}
the solutions are linked through the cutoff function and obtain the same results in the limit as $\epsilon \to 0$. It is assumed that the regularised solution is a flow generated by a point force of strength $\bm{f_0}$ located at a point $\bm{y}$ while the non-regularised solution is absent of all forces. We let $D$ be a rigid body and assume the point $\bm{x}$ is outside of $D$. Then we have that ($\bm{u},p$) satisfies \cref{eq:BIE1} with
\begin{equation*}
\sigma_{ij}(\bm{x}) = -\delta_{ik}p(\bm{x}) + \mu\left( \frac{\partial u_i}{\partial x_k} + \frac{\partial u_k}{\partial x_i} \right)
\end{equation*}
and ($\bm{u^\epsilon},p$) satisfies \cref{eq:BIE2} with
\begin{equation*}
\sigma^\epsilon_{ij}(\bm{x}) = -\delta_{ik}p^\epsilon(\bm{x}) + \mu\left( \frac{\partial u^\epsilon_i}{\partial x_k} + \frac{\partial u^\epsilon_k}{\partial x_i} \right).
\end{equation*}
We note that $\partial \sigma_{ik}(\bm{x})/ \partial x_k = 0$ and $\partial \sigma^\epsilon_{ik}(\bm{x})/ \partial x_k = -f_{0,i}\phi^\epsilon(\bm{x}-\bm{y})$ through the use of \cref{eq:BIE1,eq:BIE2} respectively. From these two equations we find that
\begin{equation*}
\begin{aligned}
  \frac{\partial}{\partial x_k}(u^\epsilon_i\sigma_{ik} - u_i\sigma^\epsilon_{ik}) &=
  \frac{\partial u^\epsilon_i}{\partial x_k} \sigma_{ik} + u^\epsilon_i\frac{\partial \sigma_{ik}}{\partial x_k} - \frac{\partial u_i}{\partial x_k} \sigma^\epsilon_{ik} - u_i\frac{\partial \sigma^\epsilon_{ik}}{\partial x_k}  \\
  & = - u_i(-f_{0,i})\phi^\epsilon  \\
  &= u_j f_{0,j}\phi^\epsilon(\bm{x}-\bm{y})
\end{aligned}
\end{equation*}
where we have replaced the summation over $i$ with a summation over $j$ without affecting the result. This forms our version of the Lorentz reciprocal identity
We now substitute in \cref{eq:regstresssol,eq:regvelsol} to obtain
\begin{equation*}
  \frac{1}{8\pi\mu}\frac{\partial}{\partial x_k}(S^\epsilon_{ij}f_{0,j}\sigma_{ik} - \mu u_i T^\epsilon_{ijk}f_{0,j}) = u_j f_{0,j}\phi_\epsilon(\bm{x}-\bm{y})
\end{equation*}
as $f_{0,j}$ is constant we can take it out of the derivative on the left-hand side and note that it is now arbitrary and as such $\bm{u}$ and $p$ obey the relation
\begin{equation}
  \label{eq:reciprocalrelation}
  \frac{1}{8\pi\mu}\frac{\partial}{\partial x_k}(S^\epsilon_{ij}\sigma_{ik} - \mu u_i T^\epsilon_{ijk}) = u_j\phi_\epsilon(\bm{x}-\bm{y}).
\end{equation}

\begin{figure}[ht]
    \centering
    \resizebox{.3\linewidth}{!}{\input{Images/Figure4}}
    \caption{Schematic diagram of the volume used to derive the boundary integral for Stokes flow}
    \label{fig:SystematicDiagram}
\end{figure}


Suppose we now let $S$ be the volume between the solid body $D$ and a sphere with a radius such that all of $D$ is contained within. We will denote $\partial S$ to be the surface of $S$, note that this contains the surface of the sphere and the surface of the solid body $\partial D$. If we now integrate the above equation over the volume $S$ then we get that
\begin{equation*}
\begin{aligned}
      &\iiint_{S} \left[\frac{1}{8\pi\mu}\frac{\partial}{\partial x_k}(S^\epsilon_{ij}\left(\bm{x}, \bm{y}\right)\sigma_{ik}\left(\bm{x}, \bm{y}\right) - \mu u_i(\bm{x}) T^\epsilon_{ijk}\left(\bm{x}, \bm{y}\right))\right] dV(\bm{x}) \\
      &= \iiint_{S} u_j(\bm{x})\phi_\epsilon(\bm{x}-\bm{y}) dV(\bm{x})  
\end{aligned}
\end{equation*}
Using the divergence theorem on the left-hand side of the equation we get that
\begin{equation*}
  \frac{1}{8\pi\mu}\iint_{\partial S} \left[S^\epsilon_{ij}\left(\bm{x}, \bm{y}\right)\sigma_{ik}\left(\bm{x}, \bm{y}\right) - \mu u_i(\bm{x}) T^\epsilon_{ijk}\left(\bm{x}, \bm{y}\right)\right]n_k ds(\bm{x}) = \iiint_{S} u_j\phi_\epsilon(\bm{x}-\bm{y}) dV(\bm{x})
\end{equation*}

where $\bm{n}$ is the outwards facing unit normal vector of $\partial S$. If we consider the limit as the radius of the sphere tends to infinity, we find that the only contributions to the left-hand side come from $\partial D$. We will introduce the traction on the surface of the sphere as $g_{i} = -\sigma_{ik}n_k$ (as the unit normal points into $D$)and obtain
\begin{equation}
\begin{aligned}
    \label{eq:BIE3}
    &\frac{1}{8\pi\mu}\iint_{\partial D} S^\epsilon_{ij}\left(\bm{x}, \bm{y}\right)g_i(\bm{x}) ds(\bm{x}) - \frac{1}{8\pi}\iint_{\partial D} u_i(\bm{x}) T^\epsilon_{ijk}\left(\bm{x}, \bm{y}\right)n_k(\bm{x}) ds(\bm{x}) \\
    &= \iiint_{S} u_j(\bm{x})\phi_\epsilon(\bm{x}-\bm{y}) dV(\bm{x})
\end{aligned}
\end{equation}

Considering the fluid inside of the solid body $D$ we realise that the velocity must satisfy the zero-deformation condition
\begin{equation*}
  \frac{\partial u_i}{\partial k} + \frac{\partial u_k}{\partial i} = 0
\end{equation*}
This gives us that $\sigma_{ik} = -p\delta_{ik}$ inside of $D$ and as such we obtain that for each $j=1,2,3$
\begin{equation*}
  \iiint_{D} \frac{\partial}{\partial x_k}\left[S^\epsilon_{ij}\left(\bm{x}, \bm{y}\right)\sigma_{ik}\left(\bm{x}, \bm{y}\right)\right]dV(\bm{x}) = -p\iiint_{D} \frac{\partial}{\partial x_k}\left[S^\epsilon_{kj}\left(\bm{x}, \bm{y}\right)\right]dV(\bm{x}) = 0
\end{equation*}
from the incompressibility condition \cref{eq:regcondition2}. If we now integrate \cref{eq:reciprocalrelation} over $D$ instead of $S$ and use the above integral we have that given $p \neq 0$
\begin{equation}
\begin{aligned}
    \label{eq:BIE4}
    -\frac{1}{8\pi}\iiint_{D} \frac{\partial}{\partial x_k}\left(u_i(\bm{x})T^\epsilon_{ijk}\left(\bm{x}, \bm{y}\right) \right) dV(\bm{x}) &= \frac{1}{8\pi}\iint_{\partial D} u_i(\bm{x})T^\epsilon_{ijk}\left(\bm{x}, \bm{y}\right)n_k(\bm{x}) ds(\bm{x})\\
    &= \iiint_D u_j(\bm{x}) \phi^\epsilon(\bm{x}-\bm{y}) dV(\bm{x})
\end{aligned}
\end{equation}
We again have used the divergence theorem to convert the volume integral to a surface integral with $n_k$ being defined to point into $D$. Observing that the sum over \cref{eq:BIE3,eq:BIE4} will give us the integral over $\mathbb{R}^{3}$ and, using the fact that the velocity is continuous on the boundary $\partial D$ we determine that final boundary integral equation is
\begin{equation}
  \label{eq:BIE5}
    \iiint_{\mathbb{R}^{3}} u_{j}(\bm{x}) \phi^{\epsilon}\left(\bm{x}-\bm{y}\right) d V(\bm{x})=-\frac{1}{8 \pi \mu} \iint_{\partial D} S_{i j}^{\epsilon}\left(\bm{x}, \bm{y}\right) g_{i}(\bm{x}) d s(\bm{x})
\end{equation}
As the traction $\bm{g}$ denotes the traction exerted by the fluid on the body it must have the opposite sign to the stokeslet traction $\bm{f}$ and as such $\bm{f} = -\bm{g}$ where $\bm{f}$ denotes the force per unit area acting on the fluid. In order to use \cref{eq:BIE5} we need to have an explicit equation for $\bm{u}(\bm{x})$, as such we need to remove the integral and the cutoff function from the left hand side of \cref{eq:BIE5}, we do this though the approximation that $\int_{\mathbb{R}^{3}} u_{j}(\bm{x}) \phi^{\epsilon}\left(\bm{x}-\bm{y}\right) d V(\bm{x}) \approx u_j(\bm{y})$. By taking the approximation as exact we write that 
\begin{equation}
    u_j(\bm{x_0}) = \frac{1}{8 \pi \mu} \iint_{\partial D} S_{i j}^{\epsilon}\left(\bm{x}, \bm{y}\right) f_{i}(\bm{x}) d s(\bm{x})
\end{equation}
By using the fact that $S_{i j}^{\epsilon}\left(\bm{x}, \bm{y}\right) = S_{j i}^{\epsilon}\left(\bm{y}, \bm{x}\right)$ we can write \cref{eq:BIE5} as 
\begin{equation}
  \label{eq:BIE}
    u(\bm{x})_i=\frac{1}{8 \pi \mu} \iint_{\partial D} S_{i j}^{\epsilon}\left(\bm{x}, \bm{y}\right) f_{j}(\bm{y}) d s(\bm{y})
\end{equation}
The analysis of this error for our particular cutoff function can be see in \cite{Cortez2005} and is found to be of order $\mathcal{O}(\epsilon)$ close to the boundary and $\mathcal{O}(\epsilon^2)$ away from the boundary.

The analytical computation of \cref{eq:BIE} is possible for certain cases allowing for the computation of the fluid velocity given prescribed body forces on the fluid, however, they are often hard or impossible to do by hand. In this case we consider the numerical integration of such problems. By approximating the boundary integral equation with a quadrature rule we obtain a formula for the velocity of the fluid at a point $\bm{y}$. To do this we consider the integral on the right-hand side of \cref{eq:BIE} as the sum over $N$ stokeslets located on the surface of $D$. 
\begin{equation}
\label{eq:Stokesletsum}
    u_{i}\left(\bm{x}\right)=\frac{1}{8 \pi \mu} \sum_{n=1}^{N} \sum_{i=1}^{3} S_{i j}^{\epsilon}\left(\bm{x}, {\bm{y}}_{n}\right) {f}_{j}({\bm{y}}_{n}) A_{n}
\end{equation}
where ${f}_{i}({\bm{y}}_n)$ is the $i$th component of the force on the fluid at the point ${\bm{y}}_n$ and $A_n$ is the corresponding quadrature weight of the $n$th stokeslet.

The discretisation of the integral in \cref{eq:BIE} introduced a discretisation error of $\mathcal{O}(h)$ where $h$ is the average spacing between quadrature points and a quadrature error which is also dependent on $\epsilon$. Analysis done by Cortez, Fauci and Medovikov \cite{Cortez2005} estimated the quadrature error introduced by this method to be $\mathcal{O}(h^2\epsilon^{-3})$ although more recently analysis by Gallagher, Choudhuri and Smith \cite{Gallagher2019SharpEquation} refined this estimate to $\mathcal{O}(h^2\epsilon^{-1}) + \mathcal{O}(P\epsilon^{-1/P} h^{1-P})$ for any integer $P>3$.

\subsection{Resistance Problem}
As \cref{eq:Stokesletsum} can be used to calculate the velocity at any point in the fluid $\bm{x}$. By forming a set of collocation points $\{\bm{x}_m\}$ for $m=1,...,M$ we form a dense system of $3M$ equations which calculate the velocity at all points in $\{\bm{x}_m\}$. 
A common problem in Stokes flow is the resistance problem, where the force distribution, and hence total force and moment, on a body is calculated from a prescribed rigid body motion. By prescribing velocities at each point $\{\bm{x}_m\}$ form a system of $3M$ equations with $3N$ unknowns $F_j(\bm{y}_n) := f_j(\bm{y}_n)A_n$. If $M \neq N$ we either under prescribe or over prescribe the system of equation, so we often choose to place both the collocation and quadrature points at the same set of positions, we will  refer to this as the Nyström discretisation \cite{Nystrom1930UberRandwertaufgaben}. For each of the rigid body motion modes, unit velocity translation along each axis and unit angular velocity rotation about each axis, are calculated we can form the grand resistance matrix $A$\cite{Pozrikidis1992BoundaryFlow}. By the linearity of Stokes equation $A$ relates the force $F$ and moment $M$ to the velocity $U$ and angular velocity $V$ for any rigid body motion. 
\begin{equation*}
\arraycolsep=1pt\def\arraystretch{1.2}
\left(
\begin{array}{c}
\boldsymbol{F} \\
\boldsymbol{M}
\end{array}\right)=\underbrace{\left(\begin{array}{cc}
A_{F U} & A_{F \Omega} \\
A_{M U} & A_{M \Omega}
\end{array}\right)}_{A}\left(\begin{array}{c}
\boldsymbol{U} \\
\boldsymbol{\Omega}
\end{array}\right) .
\end{equation*}
 For example, Stokes Law gives us for a sphere of radius $r$ centred at the origin
 \begin{equation*}
\arraycolsep=1pt\def\arraystretch{1.2}
A=\left(\begin{array}{cc}
6\pi\mu r I & 0 \\
0 & 8\pi\mu r^3 I
\end{array}\right)
\end{equation*}
where $I$ is the $3\times 3$ identity matrix and $0$ is a $3\times 3$ matrix of zeros. The formulation and computation of this systems promotes the use of formulating the problem in terms of a Vector matrix system where we can make use of highly optimised BLAS (Basic Linear Algebra Subprograms) and LAPACK (Linear Algebra PACKage) packages over direct computations in the code. This allows for the software to use the latest in hardware and software optimisations such as improved multicore algorithms and across multiple types of hardware with no changes to the higher-level code.

\subsection{Matrix formulation}
The computation of \cref{eq:Stokesletsum} for a set of collocation points $\{\bm{x}_m\}$  for $m = 1,...,M$ can be seen as a 
can be viewed as as the product of a dense $3M \times 3N$ matrix with a $3N \times 1$ column vector where $M$ is the number of collocation points and $N$ the number of stokeslet points. By taking the Nyström discretisation where we choose $\{\bm{x}_m\} = \{\bm{y}_n\}$ the stokeslet matrix therefore becomes a $3N \times 3N$ matrix where the velocity can be calculated from a set of prescribed traction $\{\bm{F}(\bm{x}_n)\}$. 
\begin{equation}
\label{eq:Nystrom}
    u_{i}\left(\bm{x}_m\right)=\frac{1}{8 \pi \mu} \sum_{n=1}^{N} \sum_{i=1}^{3} S_{i j}^{\epsilon}\left(\bm{x}_m, {\bm{x}}_{n}\right) {F}_{j}({\bm{x}}_{n})
\end{equation}
where $n=1,\dots,N$, $m=1,\dots,N$ and $j=1,2,3$. The computation of this matrix vector product can be written as 
\begin{equation}
\label{eq:matrixvectorproduct}
    \underline{U} = A \underline{F}
\end{equation}
where $\underline{U}$ is a $3N \times 1$ column vector, $A$ is a $3N \times 3N$ matrix and $\underline{F}$ is a $3N \times 1$. In order to form an equation of this form we choose to write 
\small
\begin{equation*}
    \underline{U} = [u_1(x_{1}), \; u_2(x_{1}), \; u_3(x_{1}), \; u_1(x_{2}), \; u_2(x_{2}), \; u_3(x_{2}), \; \dots \; u_1(x_{M}), \; u_2(x_{M}), \; u_3(x_{N})]^{T}
\end{equation*}
\normalsize
and 
\small
\begin{equation*}
    \underline{F} = [{f}_{1}({\bm{x}}_{1})A_1, \; {f}_{2}({\bm{x}}_{1})A_1, \; {f}_{3}({\bm{x}}_{1})A_1,\; \dots \; {f}_{1}({\bm{x}}_{N})A_N, \; {f}_{2}({\bm{x}}_{N})A_N, \; f_{3}({\bm{x}}_{N})A_N]^{T}
\end{equation*}
\normalsize
This gives the form of A as 
\small
\begin{equation*}
A = 
\begingroup
\setlength\arraycolsep{1pt}
\begin{bmatrix}
S^{\epsilon}_{11}(\bm{x}_1,{\bm{x}}_1) & S^{\epsilon}_{12}(\bm{x}_1,{\bm{x}}_1) & S^{\epsilon}_{13}(\bm{x}_1,{\bm{x}}_1) & \dots & S^{\epsilon}_{11}(\bm{x}_N,{\bm{x}}_1) & S^{\epsilon}_{13}(\bm{x}_N,{\bm{x}}_1) & S^{\epsilon}_{13}(\bm{x}_N,{\bm{x}}_1)\\
S^{\epsilon}_{21}(\bm{x}_1,{\bm{x}}_1) & S^{\epsilon}_{22}(\bm{x}_1,{\bm{x}}_1) & S^{\epsilon}_{23}(\bm{x}_1,{\bm{x}}_1) & \dots & S^{\epsilon}_{21}(\bm{x}_N,{\bm{x}}_1) & S^{\epsilon}_{22}(\bm{x}_N,{\bm{x}}_1) & S^{\epsilon}_{23}(\bm{x}_N,{\bm{x}}_1)\\
S^{\epsilon}_{31}(\bm{x}_1,{\bm{x}}_1) & S^{\epsilon}_{32}(\bm{x}_1,{\bm{x}}_1) & S^{\epsilon}_{33}(\bm{x}_1,{\bm{x}}_1) & \dots & S^{\epsilon}_{31}(\bm{x}_N,{\bm{x}}_1) & S^{\epsilon}_{32}(\bm{x}_N,{\bm{x}}_1) & S^{\epsilon}_{33}(\bm{x}_N,{\bm{x}}_1)\\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots & \vdots \\
S^{\epsilon}_{11}(\bm{x}_1,{\bm{x}}_N) & S^{\epsilon}_{12}(\bm{x}_1,{\bm{x}}_N) & S^{\epsilon}_{13}(\bm{x}_1,{\bm{x}}_N) & \dots & S^{\epsilon}_{11}(\bm{x}_N,{\bm{x}}_N) & S^{\epsilon}_{12}(\bm{x}_N,{\bm{x}}_N) & S^{\epsilon}_{13}(\bm{x}_N,{\bm{x}}_N)  \\
S^{\epsilon}_{21}(\bm{x}_1,{\bm{x}}_N) & S^{\epsilon}_{22}(\bm{x}_1,{\bm{x}}_N) & S^{\epsilon}_{23}(\bm{x}_1,{\bm{x}}_N) & \dots & S^{\epsilon}_{21}(\bm{x}_N,{\bm{x}}_N) & S^{\epsilon}_{22}(\bm{x}_N,{\bm{x}}_N) & S^{\epsilon}_{23}(\bm{x}_N,{\bm{x}}_N) \\
S^{\epsilon}_{31}(\bm{x}_1,{\bm{x}}_N) & S^{\epsilon}_{32}(\bm{x}_1,{\bm{x}}_N) & S^{\epsilon}_{33}(\bm{x}_1,{\bm{x}}_N) & \dots & S^{\epsilon}_{31}(\bm{x}_N,{\bm{x}}_N) & S^{\epsilon}_{32}(\bm{x}_N,{\bm{x}}_N) & S^{\epsilon}_{33}(\bm{x}_N,{\bm{x}}_N) \\
\end{bmatrix}
\endgroup
\end{equation*}
\normalsize
We do note that this particular choice in the structure of $U$ and $F$ is not unique and other literature may use different arrangements however they will all produce the same results. The computation of the velocities at the set of points $\{\bm{x}_n\}$ through the direct computation of the full matrix-vector product as the direct product. Assembly of the stokeslet Matrix requires $9N^2$ function evaluations followed by $\mathcal{O}(N^2)$ operations to compute the vector product. The formulation of the direct product also allows for easy application to resistance problem where $\underline{F} = A^{-1} \underline{U}$, This problem can either be solved through the inversion of the matrix $A$ or in our implementation the use of Matlab's mldivide ($\backslash$) function which both take $\mathcal{O}(N^3)$ operations to compute the solution. For larger systems where the use of mldivide becomes too computationally costly, either from time or memory, and the solution can be solved using the Generalized Minimal RESidual (GMRES) method (See \cref{appendix:GMRES}) \cite{Saad1986GMRES:Systems,Elman2005FiniteDynamics}. GMRES can perform the inverse in at worst $\mathcal{O}(N^3)$ however will more often converge to the solutions at high level of accuracy in significantly less iterations, particularly when an appropriate preconditiner is used.